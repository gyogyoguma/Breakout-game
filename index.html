<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8" />
  <link rel="stylesheet" type="text/css" href="index.css">
  <title>Gamedev Canvas Workshop</title>
</head>
<body>

<canvas id="myCanvas" width="480" height="320"></canvas>

<script>
  // JavaScript のコードはここ

  const canvas = document.getElementById("myCanvas");  // <canvas> 要素への参照を canvas に保存
  const ctx = canvas.getContext("2d"); //2D 描画コンテキストを保存するために ctx 変数を作成
  const ballRadius = 10;
  const paddleHeight = 10;
  const paddleWidth = 75;

  let paddleX = (canvas.width - paddleWidth) / 2;
  let rightPressed = false;
  let leftPressed = false;

  let x = canvas.width / 2;
  let y = canvas.height - 30;
  let dx = 2;
  let dy = -2;

  //動かないボール描画
  function drawBall() {
    ctx.beginPath();
    ctx.arc(x, y, ballRadius, 0, Math.PI * 2);
    // ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
  }

  //paddleを画面上に表示
  function drawPaddle() {
    ctx.beginPath();
    ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
    //ctx.fillStyle = "#0095DD";
    ctx.fill();
    ctx.closePath();
  }

  //ボールの移動描画
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);


    if (rightPressed) {
      paddleX = Math.min(paddleX + 7, canvas.width - paddleWidth);
    } else if (leftPressed) {
      paddleX = Math.max(paddleX - 7, 0);
    }

    if (x + dx > canvas.width-ballRadius || x + dx < ballRadius) {
      let randomColor = "rgb(" + (~~(256 * Math.random())) + ", " + (~~(256 * Math.random())) + ", " + (~~(256 * Math.random())) + ")" ;
      dx = -dx;
      ctx.beginPath();
      ctx.fillStyle = randomColor;
      ctx.closePath();
    }

    if (y + dy > canvas.height-ballRadius || y + dy < ballRadius) {
      let randomColor = "rgb(" + (~~(256 * Math.random())) + ", " + (~~(256 * Math.random())) + ", " + (~~(256 * Math.random())) + ")" ;
      dy = -dy;
      ctx.beginPath();
      ctx.fillStyle = randomColor;
      ctx.closePath();
    }

    drawBall();
    drawPaddle();

    x += dx;
    y += dy;
  }

  document.addEventListener("keydown", keyDownHandler, false);
  document.addEventListener("keyup", keyUpHandler, false);

  function keyDownHandler(e) {
  if (e.key === "Right" || e.key === "ArrowRight") {
    rightPressed = true;
  } else if (e.key === "Left" || e.key === "ArrowLeft") {
    leftPressed = true;
  }
}

function keyUpHandler(e) {
  if (e.key === "Right" || e.key === "ArrowRight") {
    rightPressed = false;
  } else if (e.key === "Left" || e.key === "ArrowLeft") {
    leftPressed = false;
  }
}

  setInterval(draw, 10);


</script>

</body>
</html>